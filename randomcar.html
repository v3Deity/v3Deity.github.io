<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">

  <!-- favicon -->
  <link rel="icon" href="favicon.png" type="image/x-icon">

  <!-- font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Libertinus+Mono&display=swap" rel="stylesheet">

  <title>Random Car Page</title>

  <link rel="stylesheet" href="style.css">
</head>

<body>

  <!--navbar-->
  <header class="navbar">
    <a href="index.html" class="navbar-icon">
      <img src="navbar-icon.png" alt="Home">
    </a>

    <nav class="navbar-links">
      <a href="index.html">Home</a>
      <span class="divider">|</span>
      <a href="about.html">About Me</a>
      <span class="divider">|</span>
      <a href="links.html">My Links</a>
      <span class="divider">|</span>
      <a href="stats.html">Statistics</a>
      <span class="divider">|</span>
      <a href="blog.html">My Blog</a>
    </nav>
  </header>

  <!-- main box -->
<div class="content-box">
  <h1>Deity's Random Car Page</h1>

  <button id="randomCarButton">
    Random Car Model
  </button>
</div>

<script>
  let cachedCars = null;

  async function goToRandomCar() {
    const button = document.getElementById("randomCarButton");

    // Fetch once and cache
    if (!cachedCars) {
      button.textContent = "Loading cars...";
      button.disabled = true;

      try {
        const res = await fetch("/data/car_models.json"); // Path to your JSON
        cachedCars = await res.json();

        // If using Sparse format with "0:" prefixes, uncomment this:
        // cachedCars = cachedCars.map(title => title.replace(/^0:/, '').replace(/ /g, "_"));
        // If already clean array, comment out above line

      } catch (err) {
        alert("Failed to load car list ");
        console.error(err);
        button.textContent = "Random Car Model";
        button.disabled = false;
        return;
      } finally {
        button.textContent = "Random Car Model";
        button.disabled = false;
      }
    }

    // Pick a random car
    const random =
      cachedCars[Math.floor(Math.random() * cachedCars.length)];

    const title = random.replace(/ /g, "_"); // spaces â†’ underscores

    window.open(
      "https://en.wikipedia.org/wiki/" + title,
      "_blank"
    );
  }

  document
    .getElementById("randomCarButton")
    .addEventListener("click", goToRandomCar);
</script>

</body>
</html>
